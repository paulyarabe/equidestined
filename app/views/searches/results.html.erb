<div class="main-container map-width z-depth-5">
  <h3 class="txt-primary">Here's the midpoint!</h3>
    <h6><%= @search.midpoint.address %></h6>
    <ul><strong>Nearby venues:</strong>
      <% @venues.each do |venue| %>
        <li><%= venue.name %> - <%= venue.address %> </li>
      <% end %>
    </ul>
  <div style='width: 100%;'>
    <div id="map" style='width: 100%; height: 300px;'></div>
  </div>

  <span class="float-right"><%= link_to "Find more midpoints", new_search_path %></span>
</div>

<script src="//maps.google.com/maps/api/js?key=AIzaSyDnqcczTMv_b43f8WvEKG1KH8n_raxpeq8"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>

<%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>

<script type="text/javascript">
  handler = Gmaps.build('Google');
  handler.buildMap(
    {
      provider: {
        disableDefaultUI: true,
        zoom: 12
        // here you can pass other Google Maps API options here
      },
      internal: {
        id: 'map'
      }
    },
    function() {
      markers = handler.addMarkers([
        {
          "lat":<%=@search.midpoint.latitude%>,
          "lng":<%=@search.midpoint.longitude%>,
          "infowindow": "The midpoint of <%=@search.locations[0].address%> and <%=@search.locations[1].address%> is here "
        },
      ]);
      handler.bounds.extendWith(markers);
      handler.map.centerOn({lat: <%=@search.midpoint.latitude%>,lng: <%=@search.midpoint.longitude%>})
    }
  );
</script>
